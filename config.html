<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin: 20px;
        background-color: #f0f0f0;
      }

      h1 {
        color: #e67900;
      }

      h2 {
        color: #8e99ae;
      }

      h3 {
        color: #e67900;
        margin-top: 20px;
      }

      /* New CSS for logo */
      .logo {
        display: block;
        margin: 20px auto;
        max-width: 150px;
      }

      /* CSS for buttons and spacing */
      button {
        padding: 10px 20px;
        font-size: 18px;
        cursor: pointer;
        background-color: #e67900;
        color: white;
        border: none;
        border-radius: 5px;
        margin: 10px; /* Added margin for spacing */
      }

      /* CSS for form containers */
      section {
        background-color: #ffffff;
        padding: 20px;
        border-radius: 5px;
        box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
        margin: 20px auto; /* Center the form */
        max-width: 600px; /* Limit form width */
      }

      label {
        display: block;
        margin-bottom: 5px;
        color: #8e99ae;
        font-weight: bold;
      }

      input[type="text"],
      input[type="file"],
      textarea {
        width: 100%;
        padding: 5px;
        margin: 5px 0;
        border: 1px solid #ccc;
        border-radius: 3px;
      }

      ul {
        list-style-type: none;
        padding: 0;
      }

      /* Additional CSS styles */
      .questionInput {
        width: 80%;
      }

      .questionContainer {
        display: flex;
        align-items: center;
      }

      .modifierQuestion,
      .supprimerQuestion {
        margin-left: 10px;
      }
    </style>
    <title>Configuration de la Campagne d'Évaluation</title>
  </head>
  <body>
    <svg
      id="Layer_1"
      data-name="Layer 1"
      xmlns="http://www.w3.org/2000/svg"
      width=""
      height="100"
      viewBox="0 0 1318.69 357.55"
    >
      <defs>
        <style>
          .cls-1 {
            fill: #2c0c07;
          }

          .cls-1,
          .cls-2 {
            stroke-width: 0px;
          }

          .cls-2 {
            fill: #ef6110;
          }
        </style>
      </defs>
      <path
        class="cls-2"
        d="m1125.17,357.55c-8.77-1.61-17.7-2.64-26.3-4.92-74.71-19.81-121.15-67.62-135.86-143.06-18.59-95.35,46.61-188.33,142.27-206.4,96.78-18.28,190.15,44.16,209.28,140.14,2,10.05,2.78,20.34,4.13,30.52v9.36c-1.22,9.22-2.11,18.5-3.72,27.65-12.28,69.54-66.46,126.26-135.36,141.75-8.7,1.96-17.53,3.31-26.29,4.94h-28.15Zm13.61-12.49c87.41,1.57,166.93-70.59,167.26-165.99.32-92.18-74.78-167.08-166.95-167.09-91.62,0-166.21,74.49-166.94,165.33-.75,93.23,76.85,168.96,166.63,167.75Z"
      />
      <g>
        <path
          class="cls-2"
          d="m323.85,123.43c7.59,4.73,12.03,10.35,11.72,18.95-.3,8.39-3.76,14.78-11.23,18.35-4.48,2.15-9.55,4.17-14.4,4.27-21.83.45-43.66.2-65.95.2v-79.97c4.25,0,8.3,0,12.35,0,15.81,0,31.62-.06,47.43.05,3.28.02,6.6.46,9.84,1.04,8.39,1.5,15.42,5.44,17.85,13.99,2.41,8.5,1.23,16.68-7.6,23.13Zm-37.13,26.22c6.04,0,12.09.06,18.13-.02,7.2-.09,11.2-3.41,11.14-9.1-.06-5.63-4.12-9.02-11.28-9.1-9.55-.11-19.1-.03-28.66-.03-14.12,0-14.03,0-13.18,13.92.2,3.25,1.31,4.45,4.55,4.37,6.43-.16,12.86-.05,19.3-.05Zm-1.14-32.76s0-.06,0-.09c6.42,0,12.86.25,19.27-.08,4.81-.25,7.97-2.65,7.91-8.11-.05-5.15-2.85-7.51-7.58-7.66-10.3-.34-20.61-.53-30.92-.61-11.89-.1-11.73-.03-11.42,11.72.1,3.88,1.51,5.05,5.22,4.91,5.83-.23,11.68-.06,17.52-.06Z"
        />
        <path
          class="cls-2"
          d="m660.74,153.13c4.61,3.9,8.84,7.48,13.07,11.05-8.45-.11-16.85,3.94-24.51-1.63-.81-.59-2.58-.16-3.8.17-15.76,4.2-31.79,3.86-47.55,1.21-20.15-3.39-32.35-21.64-30.71-43.88,1.39-18.88,17.14-33.96,37.04-34.66,11.28-.39,22.74-.75,33.87.73,33.44,4.45,40.45,41.63,25.36,62.99-.77,1.1-1.52,2.21-2.76,4.02Zm-13.71-11.43c1.56-5.22,3.28-9.45,4.06-13.85,2.48-13.93-6.33-25.86-20.38-27.07-7.91-.68-15.98-.55-23.9.1-11.34.93-17.81,7.89-19.44,19.65-1.72,12.43,3.49,25.14,13.53,27.45,9.86,2.28,20.41,1.55,30.66,2.14l.23-1.87c-4.06-3.55-8.12-7.1-12.18-10.65,9.23.54,18.61-4.1,27.43,4.1Z"
        />
        <path
          class="cls-2"
          d="m712.02,247.17v20.61h-18.83v-79.36c2.01-.13,3.9-.35,5.8-.35,16.41-.03,32.82-.12,49.23.05,4.65.05,9.38.46,13.91,1.46,12.78,2.82,21.03,11.53,22.49,23.12,1.69,13.37-3.52,23.89-15.04,30.37-.83.47-1.66.95-3.43,1.95,7.26,7.57,14.27,14.88,22.23,23.18-8.41,0-15.53.12-22.65-.1-1.31-.04-2.79-1.23-3.84-2.24-3.09-2.97-6.4-5.84-8.92-9.26-5.73-7.82-13-10.82-22.65-9.56-5.72.74-11.62.14-18.3.14Zm20.04-44.67c0,.15-.02.29-.03.44-5.27,0-10.56-.3-15.78.19-1.52.14-3.96,2.48-4.05,3.93-.43,6.98-.39,14.01-.03,21,.07,1.4,2.28,3.84,3.52,3.85,12.47.1,24.97.23,37.4-.56,7.98-.51,12.32-6.15,12.29-13.7-.03-7.59-4.34-12.7-12.36-13.68-6.95-.85-13.98-1-20.97-1.46Z"
        />
        <path
          class="cls-2"
          d="m530.81,138.08v-52.52h19.32v10.04c0,19.1-.06,38.19.04,57.29.03,5.27-.09,10.3-5.98,12.66-6.05,2.42-10.39-.49-14.53-4.55-15.32-15.02-30.74-29.94-46.14-44.88-1.08-1.05-2.32-1.93-4.51-3.74v52.45h-19.37c-.09-1.64-.28-3.49-.28-5.35-.02-21.24.05-42.48-.06-63.72-.02-4.87,1.01-9.17,5.8-11.09,4.71-1.89,9.01-.67,12.81,3.02,15.94,15.5,32.01,30.87,48.04,46.27,1.2,1.15,2.53,2.15,4.85,4.11Z"
        />
        <path
          class="cls-2"
          d="m155.32,187.5c7.55.61,15.27.42,22.62,1.98,18.74,3.98,29.7,19.42,29,39.61-.69,19.9-13.54,35.91-32.27,37.8-13.08,1.32-26.52,1.27-39.6-.09-16.82-1.74-29.78-16.74-31.33-33.74-2.48-27.2,13.54-44.8,40.99-45,3.51-.03,7.03,0,10.54,0,.01-.19.03-.37.04-.56Zm-.48,65.05c2.93,0,5.86,0,8.8,0,11.33-.02,18.48-4.79,22.07-14.72,3.85-10.65,1.18-23.47-6.18-29.76-8.98-7.66-39.76-7.53-48.58.21-7.42,6.51-9.94,19.15-5.95,29.75,3.74,9.91,10.76,14.5,22.22,14.51,2.54,0,5.08,0,7.62,0Z"
        />
        <path
          class="cls-2"
          d="m820.39,116.89c16.89,0,32.69-.06,48.49.07,2.09.02,5.88.81,5.98,1.62.51,3.96.3,8.08-.33,12.04-.11.68-3.44,1.2-5.28,1.21-14.07.1-28.14.24-42.21-.03-5.08-.1-6.84,1.49-6.76,6.66.16,11.19-.09,11.19,11.27,11.19,15.05,0,30.1.2,45.14-.12,4.81-.1,6.34,1.61,5.88,6.02-.14,1.35-.14,2.74,0,4.09.41,4.12-.96,5.83-5.54,5.79-23.45-.22-46.9-.18-70.34-.02-4.05.03-5.49-1.21-5.47-5.29.13-23.2.12-46.4,0-69.59-.02-3.97,1.21-5.41,5.38-5.38,23.64.17,47.29.16,70.93,0,3.92-.03,4.99,1.41,5.09,5.09.25,10.06.39,10.06-9.66,10.06-15.05,0-30.1.27-45.14-.13-6.04-.16-8.17,1.88-7.48,7.68.31,2.65.05,5.38.05,9.03Z"
        />
        <path
          class="cls-2"
          d="m841.99,268.23c-11.73,0-23.46-.13-35.18.07-3.9.07-5.63-.88-5.6-5.13.15-23.4.13-46.8.02-70.2-.02-3.87,1.53-4.99,5.24-4.97,23.65.12,47.3.12,70.95,0,3.79-.02,5.09,1.27,5.19,5.05.26,9.87.42,9.87-9.69,9.87-15.05,0-30.11.3-45.15-.14-6.19-.18-8.11,2.08-7.42,7.73.16,1.35.14,2.74.02,4.09-.35,4.12,1.57,5.32,5.54,5.27,14.66-.18,29.33.23,43.97-.21,6.46-.19,5.55,3.64,5.62,7.5.07,4.01.58,7.65-5.7,7.48-14.45-.39-28.93.04-43.39-.21-4.68-.08-6.06,1.63-6.12,6.09-.15,12.04-.31,12.04,11.65,12.04,14.86,0,29.71.17,44.56-.1,4.61-.09,6.56,1.28,6.04,5.89-.15,1.35-.15,2.74,0,4.09.5,4.55-1.31,6.05-5.99,5.91-11.52-.33-23.06-.11-34.59-.11Z"
        />
        <path
          class="cls-2"
          d="m18.21,268H0v-79.32c1.29-.19,2.76-.58,4.23-.58,17.96,0,35.92-.11,53.87.21,4.59.08,9.33,1.08,13.69,2.55,12.55,4.24,18.62,13.24,18.56,26.56-.05,12.26-6.37,21.35-18.82,25.06-6.42,1.91-13.36,2.43-20.11,2.81-8.17.46-16.39.09-24.59.12-7.85.03-7.85.05-7.89,7.65-.02,4.28-.05,8.57-.12,12.85,0,.54-.31,1.08-.62,2.1Zm21.21-37.68c0-.06,0-.11,0-.17,5.67,0,11.33.03,17-.03.95,0,1.9-.39,2.85-.62,7.77-1.87,11.83-6.59,11.43-13.28-.42-7-4.5-11.67-12.5-12.24-11.67-.83-23.4-.87-35.11-.83-1.38,0-3.81,2.6-3.93,4.13-.46,6.01-.06,12.08-.25,18.12-.13,3.9,1.55,5.13,5.26,4.97,5.07-.21,10.16-.05,15.24-.05Z"
        />
        <path
          class="cls-2"
          d="m224.22,228.41c0-11.69.11-23.38-.06-35.06-.06-4.04,1.38-5.41,5.46-5.36,17.57.21,35.15-.06,52.72.32,4.97.11,10.1,1.25,14.81,2.9,11.9,4.16,17.88,13.35,17.71,26-.17,12.37-6.14,21.47-18.09,25.04-6.97,2.08-14.52,2.61-21.85,3.03-8.76.5-17.57.22-26.35.09-3.69-.06-5.4,1.27-5.24,5.09.17,3.89.04,7.79,0,11.69-.01,1.36.05,3.85-.26,3.91-5.09.9-10.22,1.8-15.36,1.93-1.12.03-3.27-2.9-3.31-4.51-.29-11.68-.15-23.37-.16-35.06Zm39.07,1.9c0,.14.02.29.03.43,6.97-.45,14.04-.34,20.9-1.51,7.86-1.33,11.3-6.26,10.83-13.44-.44-6.7-4.5-11.28-12.14-11.78-11.84-.79-23.73-.87-35.6-.87-1.3,0-3.63,2.36-3.72,3.74-.41,6.39-.15,12.82-.23,19.24-.04,3.32,1.59,4.34,4.73,4.24,5.06-.16,10.13-.04,15.2-.04Z"
        />
        <path
          class="cls-2"
          d="m686.89,85.5h18.92c.11,2.08.3,4.13.31,6.18.03,12.08-.02,24.16.03,36.24.05,13.55,5.79,20.44,19.23,21.59,7.27.63,14.83.5,21.98-.83,9.82-1.82,14.46-8.34,14.56-18.34.13-12.66.04-25.33.04-37.99,0-2.11,0-4.22,0-6.72h18.95c.1,2.11.27,4.18.27,6.25.03,11.88.02,23.77.01,35.65-.02,21.67-10.03,33.79-31.34,37.56-11.83,2.09-23.67,1.89-35.41-.94-17.93-4.31-27.52-16.38-27.54-34.78-.02-14.4,0-28.79,0-43.88Z"
        />
        <path
          class="cls-2"
          d="m339.31,164.69c8.88-14.97,17.4-29.35,25.92-43.73,5.96-10.05,11.87-20.13,17.89-30.15,5.75-9.57,14.91-9.63,20.65-.03,13.99,23.4,27.87,46.87,41.76,70.33.66,1.12,1.11,2.36,1.96,4.2-6.63,0-12.64.26-18.6-.17-1.6-.12-3.88-2.06-4.43-3.65-4.06-11.69-11.93-15.59-24.09-13.99-8.25,1.09-16.78-.07-25.16.39-2.38.13-4.64,2.39-6.94,3.69-.15.08-.2.33-.3.5-8.87,15-9.35,15.22-28.68,12.61Zm54.21-57.32c-4.91,8.66-9.18,16.21-13.74,24.26h27.49c-4.53-7.99-8.62-15.21-13.75-24.26Z"
        />
        <path
          class="cls-2"
          d="m640.71,268.23c-6.75,0-12.42.3-18.03-.17-1.84-.15-4.56-1.95-5.09-3.57-4.28-13.1-13.5-16.2-26.19-14.59-7.49.95-15.2.3-22.81.12-3.53-.08-6.28.84-7.36,4.31-3.93,12.67-12.96,15.98-25.07,13.91-.94-.16-1.93-.02-3.65-.02.73-1.78,1.11-3.18,1.82-4.39,13.88-23.44,27.74-46.89,41.75-70.25,5.9-9.83,15.06-9.56,20.96.38,13.61,22.92,27.21,45.85,40.8,68.78.87,1.46,1.58,3.01,2.86,5.48Zm-68.09-33.88h27.62c-4.81-8.36-9.08-15.77-13.91-24.16-4.91,8.65-9.14,16.12-13.7,24.16Z"
        />
        <path
          class="cls-2"
          d="m349.71,188.06c0,13.16.4,25.24-.08,37.28-.97,24.26,10.53,27.48,29.85,27.81,2.71.05,5.45-.35,8.15-.7,11.08-1.47,17.07-7.06,17.69-18.17.75-13.2.71-26.46.58-39.68-.05-5.03,1.35-7.17,6.62-6.61,3.65.39,7.39.08,10.71.08.64.67,1.13.95,1.13,1.23.07,16.74.99,33.53-.13,50.19-.91,13.5-9.87,22.28-22.69,26.16-15.64,4.74-31.61,4.79-47.26.03-15.48-4.7-23.14-15.54-23.31-31.79-.14-13.24.16-26.49-.13-39.73-.11-4.97,1.72-6.56,6.46-6.16,3.83.32,7.71.07,12.4.07Z"
        />
        <path
          class="cls-2"
          d="m522.9,268.04h-77.31v-79.6h18.72v63.94h58.59v15.65Z"
        />
        <path class="cls-2" d="m671.8,188.64v79.18h-18.62v-79.18h18.62Z" />
      </g>
      <g>
        <path
          class="cls-1"
          d="m751.12,333.1v-32.56c9.14,0,18.09-.57,26.94.16,8.72.72,11.22,7.28,6.53,15.16.58-.05,1.16-.09,1.74-.14.4,3.88,1.86,8.03.95,11.57-1.19,4.64-5.97,5.73-10.47,5.78-8.36.09-16.72.03-25.68.03Zm8.28-6.71c5.9,0,11.16.23,16.36-.16,1.38-.1,2.63-2.1,3.94-3.23-1.31-1.14-2.56-3.17-3.94-3.27-5.36-.38-10.77-.16-16.36-.16v6.81Zm-.04-13.28c5.6,0,10.61.19,15.58-.13,1.24-.08,2.38-1.83,3.56-2.81-1.18-.98-2.25-2.59-3.55-2.81-2.63-.45-5.39-.15-8.09-.15-2.45,0-4.9,0-7.5,0v5.91Z"
        />
        <path
          class="cls-1"
          d="m742.94,332.87h-8.05v-16.9c-.38-.19-.77-.39-1.15-.58-2.78,3.47-5.58,6.92-8.34,10.41-4.12,5.19-6.04,5.24-10.35.01-2.71-3.28-5.28-6.68-9.03-11.43v18.34h-8.66c0-9.53-.14-18.84.14-28.14.04-1.5,1.67-3.78,3.02-4.18,1.43-.43,3.99.44,5.04,1.63,3.85,4.39,7.27,9.16,10.88,13.77,1.17,1.49,2.4,2.93,4.01,4.89,4.69-6.01,8.92-11.8,13.6-17.21,1.42-1.64,4.07-2.22,6.16-3.28.91,2.11,2.54,4.19,2.62,6.33.3,8.55.13,17.11.13,26.34Z"
        />
        <path
          class="cls-1"
          d="m291.72,324.37c3.56,2.73,6.35,4.86,9.14,7-4.84,1.67-9.33,3.53-12.49-.96-4.43-6.29-10.44-6.46-17.3-5.16-.27,2.41-.55,4.85-.86,7.56h-7.56v-32.17c8.66,0,17.37-.33,26.04.13,4.86.26,9.26,2.77,10.52,7.92,1.51,6.16.05,11.62-7.49,15.69Zm-20.81-6.43c5.47,0,10.38.48,15.11-.23,1.95-.29,4.82-3.11,4.88-4.86.06-1.8-2.6-5.03-4.41-5.29-5.04-.73-10.26-.26-15.58-.26v10.64Z"
        />
        <path
          class="cls-1"
          d="m464.41,332.98h-7.43v-32.68c7.39,0,14.94-.19,22.48.06,6.08.2,11.92,1.59,14.04,8.35,2.03,6.46-.58,11.4-6.56,15.23,2.64,2.8,5.09,5.4,8.11,8.6-4.92.58-9.53,2.25-12.56-2.23-4.43-6.55-10.56-6.08-17.41-5.18-.23,2.62-.45,5.21-.68,7.85Zm.77-25.76v10.76c5.2,0,10.11.54,14.8-.24,2.14-.36,3.85-3.33,5.75-5.11-1.91-1.8-3.62-4.79-5.78-5.16-4.68-.79-9.6-.24-14.77-.24Z"
        />
        <path
          class="cls-1"
          d="m690.45,332.8h-32.59v-32.21h32.59v6.43h-24.16c-.09,2.15-.17,3.78-.26,5.96h21.21c2.08,5.3.53,7.19-4.64,6.92-5.24-.27-10.51-.06-16.32-.06-.12,2.16-.22,3.99-.37,6.77,7,0,13.57.18,20.12-.06,4.29-.16,5.77,1.45,4.43,6.24Z"
        />
        <path
          class="cls-1"
          d="m395.94,333.08v-32.06c8.54,0,17.13-.86,25.46.24,8.64,1.14,13.1,8.73,12.21,17.79-.79,7.98-6.85,13.69-15.36,13.98-7.21.25-14.44.05-22.31.05Zm8.34-6.59c6.79-.6,14.43,2.98,18.96-3.87,1.85-2.79,1.72-8.91-.17-11.74-4.63-6.9-12.22-2.7-18.79-3.64v19.25Z"
        />
        <path
          class="cls-1"
          d="m615.16,332.84v-5.26c.59-.3,1.09-.77,1.59-.78,6.44-.11,12.91.13,19.32-.35,2.3-.17,4.47-2.04,6.7-3.14-2.18-1.09-4.28-2.76-6.57-3.12-3.43-.54-7.02,0-10.53-.2-6.87-.42-10.82-3.68-11.14-8.91-.35-5.61,3.33-9.9,10.29-10.4,7.93-.57,15.93-.13,24.32-.13.1,2.06.18,3.92.31,6.64-6.92,0-13.5-.24-20.04.14-2.09.12-4.08,1.9-6.12,2.92,2.1.96,4.13,2.48,6.31,2.75,4.24.53,8.62,0,12.85.55,6.35.83,9.03,3.94,9,9.45-.03,5.58-3.1,9.32-9.52,9.7-8.72.52-17.49.13-26.77.13Z"
        />
        <path
          class="cls-1"
          d="m865.8,332.86h-32.17v-32.17h32.46v6.31h-24.19c-.15,2.16-.26,3.77-.41,6.05h21.93v6.74h-21.62c-.1,2.36-.18,4.19-.3,6.83,6.84,0,13.23.17,19.6-.06,4.32-.15,6.42,1.07,4.7,6.29Z"
        />
        <path
          class="cls-1"
          d="m564.34,326.45v6.36h-32.68v-32.2h32.75v6.43h-24.3c-.17,2.11-.31,3.73-.5,6.03h21.98v6.69h-21.6c-.11,2.36-.19,4.18-.31,6.69h24.66Z"
        />
        <path
          class="cls-1"
          d="m387.53,300.17c0,10.17.08,19.68-.1,29.18-.02,1.26-1.43,3.55-2.17,3.53-2.12-.04-4.9-.37-6.2-1.73-5.91-6.24-11.39-12.87-17.02-19.36-.87.57-1.73,1.15-2.6,1.72v19.09h-8.7c0-9.57-.3-19.24.13-28.88.19-4.34,4.54-5.12,8.28-1.63,5.42,5.05,10.68,10.28,16.02,15.42,1.06,1.02,2.19,1.96,4.15,3.7v-20.66c2.75-.13,4.99-.23,8.2-.37Z"
        />
        <path
          class="cls-1"
          d="m571.44,332.68c0-9.59-.1-18.9.11-28.19.03-1.42,1.37-3.85,2.34-3.98,1.86-.24,4.37.29,5.75,1.48,4.69,4.08,8.99,8.61,13.48,12.94,1.81,1.74,3.7,3.39,6.47,5.92v-20.13h8.7c0,9.54.27,19.19-.12,28.81-.18,4.36-4.5,5.41-8.25,2.04-5.07-4.55-9.83-9.44-14.74-14.17-1.49-1.43-3.02-2.82-5.48-5.11v20.38h-8.25Z"
        />
        <path
          class="cls-1"
          d="m253.82,332.84c-8.03,0-15.84.54-23.53-.15-7.5-.68-12.64-7.31-13.01-15.04-.4-8.41,3.77-15.06,11.78-16.39,7.42-1.24,15.1-.96,23.14-1.37v7.3c-5.58,0-11.2-.06-16.81.02-5.94.08-9.24,3.12-9.65,8.68-.41,5.64,2.96,10.03,8.54,10.55,3.63.34,7.31.06,11.19.06.18-3.48.33-6.34.51-9.62h7.84v15.96Z"
        />
        <path
          class="cls-1"
          d="m302.19,332.6c6.23-10.49,11.94-20.41,17.99-30.11,2.31-3.7,6.1-3.53,8.43.26,5.98,9.73,11.72,19.61,17.89,29.98-5.32.61-9.78,1.56-12.04-4.42-.43-1.14-2.63-2.17-4.08-2.28-4.07-.31-8.2-.31-12.27,0-1.43.11-3.54,1.18-4,2.34-2.22,5.58-6.45,5.2-11.92,4.23Zm22.17-22.28c-1.8,3.16-3.19,5.62-4.86,8.56h9.62c-1.64-2.95-2.98-5.36-4.76-8.56Z"
        />
        <path
          class="cls-1"
          d="m825.9,332.87h-31.12v-32.2h7.76v25.96c6.67,0,12.7.17,18.71-.06,4.38-.17,6.39,1.14,4.65,6.31Z"
        />
        <path class="cls-1" d="m448.27,300.56v32.11h-7.67v-32.11h7.67Z" />
        <path
          class="cls-1"
          d="m878.45,323.78c2.11,2.47,3.41,3.98,4.71,5.5-1.6,1.27-3.29,3.66-4.76,3.53-1.79-.16-3.39-2.45-5.07-3.81,1.41-1.44,2.82-2.87,5.13-5.22Z"
        />
        <path
          class="cls-1"
          d="m504.7,323.58c2.36,2.58,3.72,4.06,5.07,5.54-1.54,1.32-3.05,3.66-4.62,3.69-1.65.03-3.34-2.13-5.02-3.34,1.22-1.58,2.45-3.17,4.56-5.9Z"
        />
      </g>
      <g>
        <path
          class="cls-1"
          d="m1099.39,243.98c-.02,1.31-.53,2.88,0,3.89,3.22,5.99,6.78,11.81,10.04,17.79,1.63,2.97,2.71,6.24,4.36,9.2.89,1.59,2.41,2.86,3.73,4.19,2.72,2.74,5.51,5.42,8.27,8.13-.33.59-.65,1.19-.98,1.78-3.41,0-6.91.43-10.2-.2-1.37-.26-2.36-2.75-3.43-4.29-1.61-2.31-3.06-4.74-4.74-6.99-1.2-1.61-3.28-2.78-3.94-4.53-3.87-10.37-8.9-19.85-17.67-27.09-1.62-1.34-1.93-4.26-3.08-7.02-.43-.1-1.56-.33-2.66-.66-3.89-1.16-4.74-4.18-2.41-7.35,3.88-5.27,7.54-10.71,11.67-16.61,3.37,3.53,10.22,4.68,11.58,11.73.51-.18,1.01-.36,1.52-.55-.8-1.76-1.18-3.95-2.47-5.21-4.18-4.08-8.9-7.62-13.04-11.74-13.07-13.06-14.9-25.92-6.33-42.25,3.22-6.13,1.81-9.78-4.98-9.84-9.59-.08-19.19,1.16-28.1,1.78,1.63-1.18,4.23-3.06,7.04-5.1-13.71.31-26.73,7.84-40.57,2.14,2.77-.51,5.54-1.01,8.31-1.52-8.26-1.52-16.87-1.57-23.22-10.08,5.02,1.44,9.08,2.6,13.22,3.79-4.68-4.96-9.09-9.63-13.49-14.3.47-.52.95-1.04,1.42-1.56,7.55,7.45,16.47,10.86,27.57,9.5-1.92-1.73-3.59-3.23-5.25-4.72.19-.27.37-.55.56-.82,2.24.46,4.53,1.43,6.72,1.26,5.08-.39,9.73.77,15.01-3.43,9.89-7.87,37.26-.56,43.27,10.62,2.15,3.99,2.13,9.14,3.25,14.45,12.25-5.98,25.43-.61,38.64-.43,9.7.13,19.43-.95,29.12-1.77,2.17-.18,4.24-1.54,7.6-2.83-5.4-3.18-9.71-5.72-14.02-8.25.12-.42.24-.84.35-1.26,3.44-.29,6.87-.58,10.69-.91-4.86-3.02-8.98-5.58-13.1-8.14.22-.45.44-.9.66-1.35h12.69c.02-.26.04-.51.06-.77-3.7-1.42-7.41-2.84-11.11-4.26.1-.45.2-.9.3-1.35,2.41-.54,4.83-1.08,8.45-1.88-2.32-1.04-3.72-1.67-5.83-2.61,2.41-.76,4.3-1.36,6.97-2.21-3.27-1.81-6.09-3.38-9.77-5.42,4.34-1.34,7.58-2.35,11.33-3.5-2.55-1.86-4.69-3.42-7.48-5.46,4.54-1.04,8.29-1.9,12.04-2.76-.02-.41-.05-.81-.07-1.22-1.9-.71-3.81-1.41-6.62-2.46,3.84-2.24,7.16-4.18,10.66-6.21-1.43-.92-2.99-1.92-5-3.21,4.13-.98,7.59-1.8,11.04-2.62,0-.42,0-.84,0-1.26-2.15-.62-4.31-1.24-6.46-1.86-.1-.4-.19-.8-.29-1.2,4.34-.95,8.68-1.9,13.22-2.9-.35-.39-1.1-1.22-1.85-2.05.06-.43.13-.85.19-1.28,3.91.77,7.83,1.54,12.15,2.39,1.99-3.01,4.31-6.5,7.44-11.23.64,4.82,1.11,8.31,1.65,12.37,2.55-2.18,4.89-4.19,7.28-6.23,3.49,4.06,7.52,7.29,2.32,13.59,6.69,2.5,12.46,5.21,18.53,6.72,3.95.98,5.31,3.47,5.34,6.44.01,1.5-2.66,3.03-4.11,4.54.27.36,1.16,1.53,2.05,2.69-2.14,1.15-5.22,3.85-6.26,3.22-7.67-4.68-14.69-.83-21.91.78-.92.21-1.9.18-3.84.35.71,4.34.83,8.64,2.17,12.52,3.5,10.1,7.87,19.9,11.28,30.03,2.77,8.23,5.55,16.63,6.71,25.17,1.32,9.68-2.71,18.32-10.53,27.13,5.09,4.44,10.1,9.01,15.33,13.32,5.47,4.52,6.14,10.69,1.75,16.25-6.5,8.23-12.14,17.29-19.48,24.67-4.87,4.91-11.54,8.89-20.38,8.15,1.99-4.16,3.7-7.76,5.53-11.61,2.28.37,4.29.7,4.67.76,3.1-4.08,5.33-7.44,7.99-10.41,4.03-4.5,8.49-8.62,12.52-13.12,2.31-2.58,2.59-5.31-1.33-6.95-6.63-2.78-13.26-5.53-21.4-8.93-3.41,7.13-6.58,14.06-10.05,20.84-1.21,2.38-3.44,4.23-4.69,6.59-3.44,6.53-6.77,13.13-9.84,19.83-2.18,4.77-.53,8.43,3.67,11.61,3.1,2.35,5.49,5.64,8.2,8.51-.25.64-.5,1.28-.75,1.92-3.52,0-7.08.31-10.53-.19-1.01-.15-2.25-2.52-2.42-3.98-.42-3.58-1.32-6.05-5.31-7.39-1.53-.51-2.71-4.06-2.79-6.27-.08-2.15,1.5-4.35,2.27-6.55,4.9-13.9,9.77-27.81,14.69-41.71,1.56-4.41,2.97-9.22,9.44-5.94-3.97-3.53-7.93-7.05-11.9-10.58-.19.07-.38.13-.56.2,1.83,2.7,3.65,5.41,6.36,9.4-10.57-.53-20.23-.92-29.87-1.57-3.49-.24-6.94-1.05-10.38-1.74-7.06-1.41-14.54-2.23-16.89-11.23,2.28,16.03-5.53,26.68-17.25,35.47-1.67,1.25-3.12,2.79-4.68,4.19-1.87,1-3.73,2-5.6,3.01Z"
        />
        <path
          class="cls-1"
          d="m1099.39,243.98c1.87-1,3.73-2,5.6-3.01,3.66,1.32,7.49,2.31,10.96,4.01,10.19,4.99,15.12,13.68,16.47,24.64.09.71-.15,1.47-.33,3.06-3.66-1.9-7.29-3.1-9.9-5.43-1.34-1.2-.6-4.5-1.26-6.72-.49-1.64-1.36-3.62-2.7-4.46-2.92-1.84-6.44-2.74-9.34-4.61-3.37-2.17-6.35-4.96-9.5-7.48Z"
        />
      </g>
    </svg>
    <!-- Insérez votre image de logo ici -->

    <h1>Configuration de la Campagne d'Évaluation</h1>

    <!-- Étape 1 : Importation des données -->
    <section id="etape1">
      <h2>Étape 1 : Importation des données de la population à évaluer</h2>
      <label for="nomCampagne">Nom de la campagne d'évaluation:</label>
      <input type="text" id="nomCampagne" name="nomCampagne" />

      <label for="fichierExcel">Importer le fichier Excel:</label>
      <input type="file" id="fichierExcel" accept=".xlsx, .xls" />
      <div id="resultat"></div>
    </section>

    <!-- Étape 2 : Écriture des questions -->
    <section id="etape2" style="display: none">
      <h2>Étape 2 : Écriture des questions de l'évaluation</h2>
      <ul id="listeQuestions">
        <!-- Les questions seront ajoutées dynamiquement ici -->
      </ul>
      <button id="ajouterQuestion">Ajouter une question</button>
      <button id="genererJSON">Générer le fichier JSON</button>
    </section>

    <!-- Étape 3 : Génération du fichier JSON -->
    <section id="etape3" style="display: none">
      <h2>Étape 3 : Génération du fichier JSON</h2>
      <textarea id="jsonOutput" rows="10" cols="50"></textarea>
      <button id="telechargerJSON">Télécharger JSON</button>
    </section>

    <script>
      // Variables globales pour stocker les données
      let donneesPopulation = [];
      let questionsEvaluation = [];

      // Étape 1 : Gestion de l'importation des données depuis un fichier Excel
      const fichierExcelInput = document.getElementById("fichierExcel");
      const importerDonneesButton = document.getElementById("importerDonnees");

      const resultatDiv = document.getElementById("resultat");

      // fichierExcelInput.addEventListener('change', (e) => {
      //     const file = e.target.files[0];
      //     if (file) {
      //         parseFichierExcel(file);
      //     }
      // });

      fichierExcelInput.addEventListener("change", (e) => {
        const fichier = e.target.files[0];

        if (fichier) {
          parseFichierExcel(fichier);
        }
      });

      function parseFichierExcel(file) {
        // Vous devez implémenter la logique de lecture du fichier Excel ici
        // Par exemple, utiliser une bibliothèque de traitement de fichiers Excel comme XLSX.js
        // Ensuite, remplir la variable 'donneesPopulation' avec les données importées
        // Exemple fictif :
        const reader = new FileReader();

        reader.onload = (event) => {
          const arrayBuffer = event.target.result;
          const workbook = XLSX.read(arrayBuffer, { type: "array" });

          // Supposons que le fichier Excel a une seule feuille, vous pouvez accéder à la première feuille comme suit :
          const firstSheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[firstSheetName];

          // Convertir les données de la feuille en un tableau JSON
          donneesPopulation = XLSX.utils.sheet_to_json(worksheet, {
            header: 1,
          });

          // Define the column that holds date values (e.g., column 'B')
          const indexDateColumn = donneesPopulation[0].length - 1;

          donneesPopulation.map((row, index) => {
            if ((index = !0)) {
              if (!isNaN(row[indexDateColumn])) {
                const excelDate = new Date(
                  (row[indexDateColumn] - 25569) * 86400 * 1000
                );
                const formattedDate = excelDate.toLocaleDateString("fr-FR", {
                  day: "2-digit",
                  month: "2-digit",
                  year: "numeric",
                });
                row[indexDateColumn] = formattedDate;
              }

              // row[indexDateColumn] = row[indexDateColumn].toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit', year: 'numeric' });
            }
          });

          // console.log(donneesPopulation);
          donneesPopulation = toNewFormat(donneesPopulation);

          // Retirer les objets (lignes) qui sont de valeur undefined
          donneesPopulation = filterObjectsWithUndefinedValues(donneesPopulation);

          // Afficher les données dans la div résultat
          // resultatDiv.textContent = JSON.stringify(donneesPopulation, null, 2);
        };

        reader.readAsArrayBuffer(file);

        // Afficher l'étape 2 une fois les données importées
        // Récupérez le nom de la campagne d'évaluation depuis le champ
        const nomCampagne = document.getElementById("nomCampagne").value;

        if (nomCampagne === "") {
          alert("Merci de saisir un nom pour cette campagne");
        } else {
          afficherEtape("etape2");
        }
      }

      // Étape 2 : Permettre à l'utilisateur de gérer les questions
      const listeQuestions = document.getElementById("listeQuestions");
      const ajouterQuestionButton = document.getElementById("ajouterQuestion");
      const genererJSONButton = document.getElementById("genererJSON");

      ajouterQuestionButton.addEventListener("click", () => {
        // L'utilisateur peut ajouter une question ici
        ajouterQuestion();
      });

      function ajouterQuestion() {
        // Créez un nouvel élément de question et ajoutez-le à la liste
        const nouvelleQuestion = document.createElement("li");
        nouvelleQuestion.innerHTML = `
                <input type="text" class="questionInput" placeholder="Entrez votre question ici">
                <button class="modifierQuestion">Modifier</button>
                <button class="supprimerQuestion">Supprimer</button>
            `;
        listeQuestions.appendChild(nouvelleQuestion);

        // Ajouter des gestionnaires d'événements pour la modification et la suppression
        const modifierQuestionButton =
          nouvelleQuestion.querySelector(".modifierQuestion");
        const supprimerQuestionButton =
          nouvelleQuestion.querySelector(".supprimerQuestion");

        modifierQuestionButton.addEventListener("click", () => {
          modifierQuestion(nouvelleQuestion);
        });

        supprimerQuestionButton.addEventListener("click", () => {
          supprimerQuestion(nouvelleQuestion);
        });
      }

      function modifierQuestion(question) {
        // L'utilisateur peut modifier la question ici
        const questionInput = question.querySelector(".questionInput");
        // Mettez en œuvre la logique de modification
      }

      function supprimerQuestion(question) {
        // L'utilisateur peut supprimer la question ici
        listeQuestions.removeChild(question);
      }

      // Étape 3 : Générer le fichier JSON final
      const jsonOutput = document.getElementById("jsonOutput");
      let jsonData = null;

      genererJSONButton.addEventListener("click", () => {
        const managers = [];

        // Stockez toutes les questions dans la variable 'questionsEvaluation'
        questionsEvaluation = Array.from(
          listeQuestions.querySelectorAll(".questionInput")
        ).map((input) => input.value);

        // Récupérez le nom de la campagne d'évaluation depuis le champ
        const nomCampagne = document.getElementById("nomCampagne").value;

        // Créez une liste de gestionnaires à partir des données de la population
        for (const data of donneesPopulation) {
          const managerId = data["MATRICULE MANAGER N+1"];
          const password = data["BIRTHDAY MANAGER N+1"];
          console.log(password);

          // Remove '/' characters from the date string and format it as 'DDMMYYYY'
          const formattedPassword = password.replace(/\//g, ""); // Removes all '/' occurrences
          managers.push({
            id: managerId.toString(),
            password: formattedPassword,
          });
        }

        const employees = [];

        // Créez une liste d'employés avec des questions d'évaluation
        for (const data of donneesPopulation) {
          const employeeName = `${data.PRENOM} ${data.NOM}`;
          const managerId = data["MATRICULE MANAGER N+1"];

          const employee = {
            name: employeeName,
            manager: managerId.toString(),
            BPR: data["BPR"],
            programs: questionsEvaluation.map((q) => ({ question: q })),
          };

          employees.push(employee);
        }

        // Créez l'objet JSON final
        jsonData = {
          campagne_ID: nomCampagne,
          managers: managers,
          employees: employees,
        };

        // Affichez le JSON généré dans le textarea
        jsonOutput.value = JSON.stringify(jsonData, null, 2);

        // Afficher l'étape 3
        afficherEtape("etape3");
      });

      const telechargerJSONButton = document.getElementById("telechargerJSON");

      telechargerJSONButton.addEventListener("click", () => {
        // Récupérez le JSON généré
        // Convertissez l'objet JSON en une chaîne JSON
        const jsonStr = JSON.stringify(jsonData, null, 2);

        // Créez une nouvelle date pour obtenir la date de génération du fichier
        const currentDate = new Date();

        // Générez le nom de fichier souhaité avec l'ID de la campagne et la date
        const nomFichier = `${capitalizeAndRemoveSpaces(
          jsonData["campagne_ID"]
        )}_${currentDate.toISOString().split("T")[0]}_config.JSON`;

        // Créez un objet Blob pour le contenu JSON
        const blob = new Blob([jsonStr], { type: "application/json" });

        // Créez un URL objet pour le Blob
        const url = URL.createObjectURL(blob);

        // Créez un élément d'ancrage pour le téléchargement
        const a = document.createElement("a");
        a.href = url;
        a.download = nomFichier;

        // Cliquez sur l'élément d'ancrage pour déclencher le téléchargement
        a.click();

        // Révoquez l'URL pour libérer les ressources
        URL.revokeObjectURL(url);
      });

      // Fonction pour afficher une étape et masquer les autres
      function afficherEtape(etapeId) {
        const etapes = document.querySelectorAll("section");
        etapes.forEach((etape) => {
          if (etape.id === etapeId) {
            etape.style.display = "block";
          } else {
            etape.style.display = "none";
          }
        });
      }

      function toNewFormat(arr) {
        let newArr = [];

        for (let i = 1; i < arr.length; i++) {
          // Commencez à l'index 1 pour éviter l'en-tête
          const ligne = arr[i];
          const objetJSON = {};
          for (let j = 0; j < arr[0].length; j++) {
            const cle = arr[0][j];
            const valeur = ligne[j];
            objetJSON[cle] = valeur;
          }
          // console.log(objetJSON);
          newArr.push(objetJSON);
        }

        return newArr;
      }

      function capitalizeAndRemoveSpaces(inputString) {
        // Split the input string into words using space as a delimiter
        const words = inputString.split(" ");

        // Capitalize the first letter of each word and remove spaces
        const capitalizedWords = words.map((word) => {
          return word.charAt(0).toUpperCase() + word.slice(1);
        });

        // Join the capitalized words back together without spaces
        const resultString = capitalizedWords.join("");

        return resultString;
      }

      function filterObjectsWithUndefinedValues(jsonList) {
        return jsonList.filter((obj) => {
          // Vérifie si au moins une valeur de clé n'est pas undefined
          return Object.values(obj).some((value) => value !== undefined);
        });
      }
    </script>
  </body>
</html>
